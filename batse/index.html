

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The batse5bp package &mdash; batse5bp 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="batse5bp 0.2 documentation" href="#" /> 
  </head>
  <body>

<div class="banner">
<a href="#"><img src="_static/batse.gif" border="0" alt="BATSE on CGRO"/></a>
batse5bp
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The batse5bp package</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#loading-the-catalog">Loading the catalog</a></li>
<li><a class="reference internal" href="#the-grbcollection-object">The GRBCollection object</a></li>
<li><a class="reference internal" href="#the-grb-object-catalog-data">The GRB object: Catalog data</a></li>
<li><a class="reference internal" href="#accessing-documentation-for-catalog-and-detailed-data">Accessing documentation for catalog and detailed data</a></li>
<li><a class="reference internal" href="#the-grb-object-detailed-data">The GRB object: Detailed data</a><ul>
<li><a class="reference internal" href="#light-curve-plots">Light curve plots</a></li>
<li><a class="reference internal" href="#compiled-64-ms-count-data-ascii64">Compiled 64 ms count data (ASCII64)</a></li>
<li><a class="reference internal" href="#detector-response-matrices-drms">Detector response matrices (DRMs)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-batse5bp-package">
<h1>The batse5bp package<a class="headerlink" href="#the-batse5bp-package" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">batse5bp</span></tt> package provides persistant local access to BATSE GRB data hosted
at the CGRO SSC.  It accesses both the BATSE GRB <strong>catalog</strong> (a collection of
basic properties of all detected bursts, such as directions, intensities, and
durations), and <strong>detailed GRB data</strong> (e.g., time
series and spectral data).</p>
<p>The last official BATSE GRB catalog was the 4B catalog.  The &#8220;current&#8221; catalog
hosted at the SSC includes many GRBs observed subsequent to the 4B catalog.  A
5B catalog, including data spanning to the end of the CGRO mission, was
planned but was never completed (in particular, the sky exposure and efficiency
tables were never computed).  The &#8220;5bp&#8221; part of the package name denotes &#8220;5B,
preliminary&#8221; (5Bp).</p>
<p>The full 5Bp GRB catalog is fetched, parsed, and stored locally when the
user first loads the catalog.  Subsequent loads access the stored copy.
Detailed GRB data, which would be voluminous if downloaded en masse, is
fetched transparently only when the user first attempts to access it.
Only the requested data element, for a particular GRB, is fetched; it is
cached locally for subsequent access.</p>
<p>Cached data is stored in a local file hierarchy with a structure resembling
that of the SSC archive.  Files and folders may be deleted within the local
filesystem when no longer needed; they will be re-fetched as necessary.  There
is no monolithic database file, and no dependencies on 3rd-party database
software.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">batse5bp</span></tt> is currently a pure-Python package with only <tt class="docutils literal"><span class="pre">numpy</span></tt> and
<tt class="docutils literal"><span class="pre">pyfits</span></tt> as dependencies (some example code here also relies on
<tt class="docutils literal"><span class="pre">matplotlib</span></tt>).  It is provided as a gzipped tar file containing the source
code, &#8220;batse5bp-0.1.tar.gz&#8221;.  It could be installed by unpacking and using the
standard <tt class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></tt> command.  But the package is evolving so
the recommended method is to use <tt class="docutils literal"><span class="pre">pip</span></tt>, which will allow easy uninstallation
and replacement:</p>
<div class="highlight-sh"><div class="highlight"><pre>pip install batse5bp-0.1.tar.gz
</pre></div>
</div>
<p>To uninstall it:</p>
<div class="highlight-sh"><div class="highlight"><pre>pip uninstall batse5bp
</pre></div>
</div>
</div>
<div class="section" id="loading-the-catalog">
<h2>Loading the catalog<a class="headerlink" href="#loading-the-catalog" title="Permalink to this headline">¶</a></h2>
<p>To establish access to the 5Bp data, use the <tt class="docutils literal"><span class="pre">load_catalog()</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">batse5bp</span> <span class="kn">import</span> <span class="n">load_catalog</span>

<span class="c"># Load the catalog using the default database location (in the CWD):</span>
<span class="n">grbcat</span> <span class="o">=</span> <span class="n">load_catalog</span><span class="p">()</span>
</pre></div>
</div>
<p>The first time it&#8217;s run, <tt class="docutils literal"><span class="pre">load_catalog()</span></tt> creates a database directory for
storing fetched data, grabs the 5Bp catalog files from the SSC, parses
them, collects the data in an object, and saves a serialized version of
the object in the database for future access.  The return value is the
object providing access to the data, described below.</p>
<p>By default, the database directory is named &#8220;BATSE_5Bp_Data&#8221; and is created or
accessed in the current working directory (CWD).  To create it elsewhere, or
with a different name, or to access a previously loaded database stored
elsewhere, provide the database directory path as an argument to
<tt class="docutils literal"><span class="pre">load_catalog()</span></tt>.</p>
</div>
<div class="section" id="the-grbcollection-object">
<h2>The GRBCollection object<a class="headerlink" href="#the-grbcollection-object" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">load_catalog()</span></tt> returns a <tt class="docutils literal"><span class="pre">GRBCollection</span></tt> object that stores the
data in <tt class="docutils literal"><span class="pre">GRB</span></tt> objects, one for each GRB.</p>
<p>A <tt class="docutils literal"><span class="pre">GRBCollection</span></tt> is a <em>mapping</em> (like a Python <tt class="docutils literal"><span class="pre">dict</span></tt>), providing access to
the data for individual GRBs by using the BATSE trigger number (an integer) as
a key.  For example, <tt class="docutils literal"><span class="pre">grbcat[105]</span></tt> returns a <tt class="docutils literal"><span class="pre">GRB</span></tt> instance providing
access to the data for BATSE trigger 105, the first GRB observed by BATSE.</p>
<p>A <tt class="docutils literal"><span class="pre">GRBCollection</span></tt> is an <em>ordered</em> mapping, so if you iterate over it, you
will access the GRB instances in order of the BATSE trigger number.  (A
standard Python <tt class="docutils literal"><span class="pre">dict</span></tt> returns its keys and items in an arbitrary order.)</p>
<p>For convenience, besides the standard <tt class="docutils literal"><span class="pre">dict</span></tt> keyword
access, you can access GRB data via <em>attributes</em>, in two ways:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">grbcat.tN</span></tt> returns the GRB instance for trigger number <em>N</em>, e.g.,
<tt class="docutils literal"><span class="pre">grbcat.t105</span></tt> returns the instance for trigger 105.</li>
<li><tt class="docutils literal"><span class="pre">grbcat.bYYMMDD</span></tt> returns a <strong>list</strong> of GRB instances for bursts
that occured on the specified date, in the YYMMDD format that is
traditional for identifying GRBs.  For example, <tt class="docutils literal"><span class="pre">grbcat.b910421</span></tt>
returns a list with one element, the GRB instance with the data
for trigger 105, which happens to be GRB&nbsp;910421.  A list is
returned because more than one burst
may have occured on a given day.  (Although conventional GRB
nomenclature distinguishes such bursts with lower case letter
suffixes, the current BATSE catalog does not provide such full
IDs, which would require coordination with catalogs from other
missions.)</li>
</ul>
<p>So all three of the following <tt class="docutils literal"><span class="pre">GRB</span></tt> instances are the same:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">grb</span> <span class="o">=</span> <span class="n">grbcat</span><span class="p">[</span><span class="mi">105</span><span class="p">]</span>
<span class="n">grb2</span> <span class="o">=</span> <span class="n">grbcat</span><span class="o">.</span><span class="n">t105</span>
<span class="n">grb3</span> <span class="o">=</span> <span class="n">grbcat</span><span class="o">.</span><span class="n">b910421</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-grb-object-catalog-data">
<h2>The GRB object: Catalog data<a class="headerlink" href="#the-grb-object-catalog-data" title="Permalink to this headline">¶</a></h2>
<p>You can access the data and metadata for a GRB via the attributes
and methods of its <tt class="docutils literal"><span class="pre">GRB</span></tt> instance.</p>
<p>Suppose you load the catalog in an interactive IPython session, and
grab the <tt class="docutils literal"><span class="pre">GRB</span></tt> instance for trigger 105, as follows:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">matplotlib.pylab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="gp">In [2]: </span><span class="n">ion</span><span class="p">()</span>  <span class="c"># for interactive plotting in examples below</span>

<span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">batse5bp</span> <span class="kn">import</span> <span class="n">load_catalog</span>

<span class="gp">In [4]: </span><span class="n">grbcat</span> <span class="o">=</span> <span class="n">load_catalog</span><span class="p">()</span>
<span class="go">Loaded summary data for 2702 GRBs comprising the 5Bp catalog.</span>

<span class="gp">In [5]: </span><span class="n">grb</span> <span class="o">=</span> <span class="n">grbcat</span><span class="o">.</span><span class="n">t105</span>
</pre></div>
</div>
<p>The string representation of <tt class="docutils literal"><span class="pre">grb</span></tt> (what gets shown by a <tt class="docutils literal"><span class="pre">print</span></tt>
statement) provides a handy summary of the data in the burst&#8217;s
catalog entries:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="k">print</span> <span class="n">grb</span>
<span class="go">Trigger:  105</span>
<span class="go">Name:  4B_910421</span>
<span class="go">TJD:   8367.384766</span>
<span class="go">(RA, Dec) (long, lat) (deg):    (270.68   24.76)  ( 21.19   50.75)</span>
<span class="go">Drxn err (deg):    0.53</span>
<span class="go">Complete?  True</span>
<span class="go">Ch 1-4 fluence (ergs):  8.7e-07  1.3e-06  2.0e-06  1.0e-06</span>
<span class="go">Ch 1-4 S/N:             8.0e+01  9.2e+01  1.1e+01  5.8e+00</span>
<span class="go">64ms F_pk (cts), S/N, t:   12.76   23.46     3.84</span>
<span class="go">T50, T90:    1.79    5.18</span>
<span class="go">A:  Ulysses, PVO rate increase</span>
<span class="go">O:  Background source (Cyg X-1)</span>
<span class="go">Q:  Data gap during burst accumulation; HV turnoff at T+38 s</span>
</pre></div>
</div>
<p>Each item can be accessed as an attribute of <tt class="docutils literal"><span class="pre">grb</span></tt>; for example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [11]: </span><span class="n">grb</span><span class="o">.</span><span class="n">trigger</span>
<span class="gr">Out[11]: </span><span class="mi">105</span>

<span class="gp">In [12]: </span><span class="n">grb</span><span class="o">.</span><span class="n">desig</span>
<span class="gr">Out[12]: </span><span class="s">&#39;910421&#39;</span>

<span class="gp">In [13]: </span><span class="p">(</span><span class="n">grb</span><span class="o">.</span><span class="n">F64ms</span><span class="p">,</span> <span class="n">grb</span><span class="o">.</span><span class="n">F64ms_err</span><span class="p">)</span>
<span class="gr">Out[13]: </span><span class="p">(</span><span class="mf">12.761</span><span class="p">,</span> <span class="mf">0.544</span><span class="p">)</span>
</pre></div>
</div>
<p>These attributes contain, respectively, the trigger number, the designator in
YYMMDD format (but omitting a possible lower-case suffix), and the 64&nbsp;ms time scale peak flux and its error.  See the <tt class="docutils literal"><span class="pre">grb</span></tt> module API
documentation (in the Module Index, linked below) for more information about
the attributes holding the catalog data.</p>
<p>Of note is the inclusion of information from the BATSE &#8220;Comments&#8221; table
in the <tt class="docutils literal"><span class="pre">GRB</span></tt> instance:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [14]: </span><span class="n">grb</span><span class="o">.</span><span class="n">comments</span>
<span class="go">Out[14]:</span>
<span class="go">[(&#39;A&#39;, &#39;Ulysses, PVO rate increase&#39;),</span>
<span class="go"> (&#39;O&#39;, &#39;Background source (Cyg X-1)&#39;),</span>
<span class="go"> (&#39;Q&#39;, &#39;Data gap during burst accumulation; HV turnoff at T+38 s&#39;)]</span>
</pre></div>
</div>
<p>There were unusual circumstances for a number of GRBs that can impact
interpretation of the data; the comments describe most such cases.
A burst may have multiple comments associate with it, each with a
flag identifying the comment type.  The <tt class="docutils literal"><span class="pre">comments</span></tt> attribute is a
list of 2-tuples containing the flag and its associated comment.</p>
</div>
<div class="section" id="accessing-documentation-for-catalog-and-detailed-data">
<h2>Accessing documentation for catalog and detailed data<a class="headerlink" href="#accessing-documentation-for-catalog-and-detailed-data" title="Permalink to this headline">¶</a></h2>
<p>To understand the comments and the other catalog attributes, the
authoritative reference is the catalog description text available at
the SSC.  The package provides local copies of the text for the
various tables comprising the catalog in the <tt class="docutils literal"><span class="pre">docn</span></tt> module.  For
example, to see an explanation of the comments:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="kn">from</span> <span class="nn">batse5bp</span> <span class="kn">import</span> <span class="n">docn</span>

<span class="gp">In [16]: </span><span class="k">print</span> <span class="n">docn</span><span class="o">.</span><span class="n">comments</span>
<span class="go">The COMMENTS Table contains comments relevant to BATSE gamma-ray burst data</span>
<span class="go">found in the GROSSC BATSE burst catalog. Each category of comment is sorted by</span>
<span class="go">a flag identification and ordered by BATSE trigger number. A gamma-ray burst</span>
<span class="go">may have more than one entry or may have no entry.</span>

<span class="go">Flag  Definition</span>
<span class="go">Q     comments on data quality</span>
<span class="go">A     additional observations by other instruments</span>
<span class="go">O     general comments</span>
<span class="go">L     comments on the gamma-ray burst coordinates</span>
<span class="go">T     comments on the gamma-ray burst duration</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">docn</span></tt> module contains similar text strings for the three other tables
comprising the catalog:  <tt class="docutils literal"><span class="pre">basic</span></tt> (with the trigger number, data, direction,
overwrite flag, etc.), <tt class="docutils literal"><span class="pre">flux</span></tt> (with peak fluxes and fluences), and <tt class="docutils literal"><span class="pre">durn</span></tt>
(with durations).</p>
<p>The <tt class="docutils literal"><span class="pre">docn</span></tt> module also provides convenience functions that will
open important web pages at the SSC in your default browser.  For
convenience, these are all inserted into the <tt class="docutils literal"><span class="pre">batse5bp</span></tt> namespace:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">docn.show_ssc()</span></tt></dt>
<dd>Show the COSSC web site.</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_archive()</span></tt></dt>
<dd>Show a description of the CGRO data archive contents, including a list of the
available detailed data types.</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_4B()</span></tt></dt>
<dd>Show the 4B catalog web site.
(The 4B catalog remains useful as the largest catalog with
exposure and efficiency tables; also, the 4B bursts have
official designators, including letter suffixes in cases where
multiple bursts happened on the same day.)</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_5Bp()</span></tt></dt>
<dd>Show the 5Bp (&#8220;current&#8221;) catalog web site.</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_problems()</span></tt></dt>
<dd>Show the BATSE data problems archive.</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_tech()</span></tt></dt>
<dd>Show the the BATSE technical description from the CGRO GI program RA,
with basic information about the detailed data types.</dd>
<dt><tt class="docutils literal"><span class="pre">docn.show_sw()</span></tt></dt>
<dd>Show the SSC software directory.</dd>
</dl>
<p>The problems archive has text files identified by trigger number that
describe problems with the data for a few dozen bursts, beyond what
is mentioned in the Comments table.</p>
</div>
<div class="section" id="the-grb-object-detailed-data">
<h2>The GRB object: Detailed data<a class="headerlink" href="#the-grb-object-detailed-data" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">GRB</span></tt> instances provide access to some of the detailed data for each
GRB stored at the SSC in FITS files and files of other formats.</p>
<p>When a user firsts requests access to a particular detailed data type, the
corresponding FITS file is fetched from the SSC and stored in the <cite>raw_cache</cite>
directory within the database directory.  The file is parsed, and the parsed
data is cached elsewhere in the database.  Future access of the data will access
the already-parsed cached version.  The FITS file is not deleted after parsing,
but the user can delete any of the contents of the <cite>raw_cache</cite> directory (e.g.,
to reclaim space); FITS files will not be re-downloaded if they have been
previously downloaded and parsed.</p>
<p>Users who examine FITS file contents not exposed by <tt class="docutils literal"><span class="pre">batse5bp</span></tt> may note
that the sky locations in the FITS header for a trigger need not match
the catalog location.  The catalog locations were calculated after the
locations in the detailed data FITS headers using improved algorithms.
This is discussed further in the <a class="reference external" href="ftp://legacy.gsfc.nasa.gov/compton/data/batse/trigger//00000README">SSC trigger archive README file</a>.</p>
<div class="section" id="light-curve-plots">
<h3>Light curve plots<a class="headerlink" href="#light-curve-plots" title="Permalink to this headline">¶</a></h3>
<p>The simplest detailed data are light curve plots, stored as GIF image files at
the SSC.  Two plots are archived: one shows 64&nbsp;ms count data from each
of BATSE&#8217;s four discriminator (DISC) channels, the other shows the summed
light curve.  The <tt class="docutils literal"><span class="pre">show_lc()</span></tt> method fetches the images, creates a
single image from them, and displays it using your default image viewer.
The images are stored in the local database for future use.  This is a
good way to get a quick sense of what the data look like, but note that
the archived light curves often show only a subset of the data.</p>
</div>
<div class="section" id="compiled-64-ms-count-data-ascii64">
<h3>Compiled 64 ms count data (ASCII64)<a class="headerlink" href="#compiled-64-ms-count-data-ascii64" title="Permalink to this headline">¶</a></h3>
<p>The BATSE team has compiled three different DISC data types into a four- channel
&#8220;64&nbsp;ms&#8221; binned counts data set for each burst, stored as an ASCII file.
These data are summed count <em>rates</em> (float-valued counts-per-second) from the
subset of BATSE&#8217;s eight detectors that were triggered by a burst.  Two of the
data types contain genuine 64&nbsp;ms data associated with a trigger: the PREB
(PRE-Burst) and DISCSC (DISCriminator SCience) data.  To extend coverage
further, both before and after the time covered by PREB and DISCSC, the BATSE
team used the continuously-recorded 256&nbsp;ms DISCLA (DISCriminator Large
Area) data to estimate 64&nbsp;ms count rates prior to the PREB and after the
DISCSC data.  The early ASCII data thus has contiguous sets of 16 bins with
identical count rates. Since the trigger need not be at the boundary of a 256&nbsp;ms DISCLA interval, there is often a single set of fewer than 16 ASCII
bins with identical rates, just before the PREB data.</p>
<p>A detailed description of the ASCII 64&nbsp;ms data, copied from the SSC,
is available as a string in the <tt class="docutils literal"><span class="pre">ascii64</span></tt> module:  <tt class="docutils literal"><span class="pre">ascii64.docn</span></tt>.</p>
<p><em>Note that the BATSE DISC pulse height channels are conventionally numbered
from 1 to 4, but are accessed in Python code using 0-based indexing, i.e.,
numbered from 0 to 3.</em></p>
<p><tt class="docutils literal"><span class="pre">GRB</span></tt> instances have an <tt class="docutils literal"><span class="pre">ascii64</span></tt> attribute that provides access to the
ASCII 64&nbsp;ms data via an <tt class="docutils literal"><span class="pre">ASCII64</span></tt> object with several attributes and
one method providing different views of the data.  The aim of this object is to
report integer-valued <em>counts</em> (not rates), in the actual 64 and 256&nbsp;ms
bins used for measurements, by re-binning the subdivided DISCLA data, and
converting the rate estimates back to counts. Presently this is only correctly
done for the early (pre-PREB) DISCLA data.  Fortunately, most bursts are short
enough that late-time (post-DISCSC) DISCLA data will typically be ignored.  But
for long bursts, the user should use this ASCII data with caution, finding a way
to handle the late-time subdivided DISCLA data.  For the early mission, the
DISCSC data duration is ~4&nbsp;m; later in the mission the flight
software was reconfigured to provide ~10&nbsp;m of DISCSC data. The late-time
DISCLA bins appear after these intervals.</p>
<p>For the attribute descriptions below:</p>
<ul class="simple">
<li>Counts are in integer arrays, and times are in float arrays.</li>
<li>Unless otherwise specified, the time arrays list bin <em>boundaries</em>,
consecutively, so if there are N bins, the time array will have length N+1.</li>
<li>Times are in seconds relative to the trigger time.</li>
<li>Count data is provided in 4-row arrays, so that <tt class="docutils literal"><span class="pre">counts[i,j]</span></tt> is the
number of counts in time bin <tt class="docutils literal"><span class="pre">j</span></tt> for channel <tt class="docutils literal"><span class="pre">i</span></tt>, and <tt class="docutils literal"><span class="pre">counts[2,:]</span></tt>
is an N-vector containing the count time series for channel 2.</li>
</ul>
<p>One set of attributes makes the data with different binning separately
available.  <tt class="docutils literal"><span class="pre">early</span></tt> and <tt class="docutils literal"><span class="pre">t_early</span></tt> provide the counts and
time bin boundaries for the early 256&nbsp;ms DISCLA data.
Similarly, <tt class="docutils literal"><span class="pre">late</span></tt> and <tt class="docutils literal"><span class="pre">t_late</span></tt>
provide counts and times for the 64&nbsp;ms PREB and DISCSC
data (but including any late-time subdivided DISCLA data).
In cases where there is a single truncated DISCLA bin before the
PREB data, the <tt class="docutils literal"><span class="pre">mid</span></tt> and <tt class="docutils literal"><span class="pre">t_mid</span></tt> attributes contain the single
photon count value in the truncated bin (as a length-1 NumPy integer array),
and its time boundaries (as a length-2 float array).  If there
is no truncated DISCLA bin, the value of <tt class="docutils literal"><span class="pre">mid</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<p>This block of code prints the last few counts in the <tt class="docutils literal"><span class="pre">early</span></tt> array, the
<tt class="docutils literal"><span class="pre">mid</span></tt> counts (if present, else <tt class="docutils literal"><span class="pre">None</span></tt>), and the first few counts in the
<tt class="docutils literal"><span class="pre">late</span></tt> array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">asc</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">ascii64</span>
<span class="k">print</span> <span class="s">&#39;Early:&#39;</span><span class="p">,</span> <span class="n">asc</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<span class="k">print</span> <span class="s">&#39;Mid:&#39;</span><span class="p">,</span> <span class="n">asc</span><span class="o">.</span><span class="n">mid</span>
<span class="k">print</span> <span class="s">&#39;Late: &#39;</span><span class="p">,</span> <span class="n">asc</span><span class="o">.</span><span class="n">late</span><span class="p">[</span><span class="mi">0</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>A second set of attributes concatenates the data into single count and time
arrays.  <tt class="docutils literal"><span class="pre">counts</span></tt> contains all of the counts in time sequence.  <tt class="docutils literal"><span class="pre">times</span></tt>
contains the boundaries of all of the time bins.</p>
<p>The <tt class="docutils literal"><span class="pre">rates</span></tt> method returns a 3-tuple of NumPy arrays built from the
concatenated data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">rates</span><span class="p">)</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">ascii64</span><span class="o">.</span><span class="n">rates</span><span class="p">()</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">centers</span></tt> contains the center times of the bins, <tt class="docutils literal"><span class="pre">widths</span></tt> contains
the durations of the bins, and <tt class="docutils literal"><span class="pre">rates</span></tt> is a 4-row array containing counting rate
estimates found by dividing the counts by the bin width.  This is
intended for plotting light curves.  The following block of code
uses <tt class="docutils literal"><span class="pre">matplotlib</span></tt> to plot the light curves for each channel in a common figure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">asc</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">ascii64</span>
<span class="n">t</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">asc</span><span class="o">.</span><span class="n">rates</span><span class="p">()</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">ch</span><span class="p">,:],</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>
<span class="n">axvline</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>  <span class="c"># show the trigger time</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$t$ (s from trigger)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">r&#39;$Rate$ (counts/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(This plots the light curve as a curve; a histogram would be a more
accurate representation of the data.)</p>
</div>
<div class="section" id="detector-response-matrices-drms">
<h3>Detector response matrices (DRMs)<a class="headerlink" href="#detector-response-matrices-drms" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">GRB</span></tt> instances have a <tt class="docutils literal"><span class="pre">discsc_drms</span></tt> attribute providing access to the
DRMs for the DISC channels of triggered detectors, via a <tt class="docutils literal"><span class="pre">DRMs_DISCSC</span></tt>
object.  This object contains <tt class="docutils literal"><span class="pre">DRM</span></tt> objects that hold the DRM data for each
triggered detector.  It also provides access to a DRM that sums the response
of the triggered detectors.</p>
<p>Users should note that the archived DRMs are fairly coarsely sampled.  Also, the
response for DISC channel 4 is relatively flat over the tabulated range and is
simply truncated at the high-energy end of the range (about 20&nbsp;MeV;
in fact, the response is typically <em>rising</em> slowly with energy above a few MeV).
Integrals of the product of an incident flux model and the channel response will
be inaccurate if the incident flux does not fall with energy at least as quickly
as 1/E**2 above ~1&nbsp;MeV.</p>
<p><tt class="docutils literal"><span class="pre">discsc_drms.n_det</span></tt> is the number of triggered detectors.</p>
<p>Two <tt class="docutils literal"><span class="pre">discsc_drms</span></tt> attributes describe the common format
of the DRMs for the triggered detectors and the summed response:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">n_ch</span></tt></dt>
<dd>The number of pulse height channels (always 4 for DISC data).</dd>
<dt><tt class="docutils literal"><span class="pre">n_E</span></tt></dt>
<dd>Each channel&#8217;s response is described by a vector evaluating the response
function at <tt class="docutils literal"><span class="pre">n_E</span></tt> values of incident photon energy (at least in <em>theory</em>—see the <tt class="docutils literal"><span class="pre">E_bins</span></tt> attribute, below).</dd>
</dl>
<p>A DRM is a matrix defined so <tt class="docutils literal"><span class="pre">drm[i,j]</span></tt> is the response of channel <tt class="docutils literal"><span class="pre">i</span></tt> for
the <tt class="docutils literal"><span class="pre">j</span></tt>&#8216;th value of incident photon energy.</p>
<p><tt class="docutils literal"><span class="pre">discsc_drms.detectors</span></tt> is a list of <tt class="docutils literal"><span class="pre">DRM</span></tt> instances, one for each
triggered detector.</p>
<p><tt class="docutils literal"><span class="pre">DRM</span></tt> instances have the following attributes:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">det_num</span></tt></dt>
<dd>The detector number, an integer from 1 to 8.</dd>
<dt><tt class="docutils literal"><span class="pre">ch_bins</span></tt></dt>
<dd>The pulse height bin boundaries, in units of nominal deposited energy
in keV.</dd>
<dt><tt class="docutils literal"><span class="pre">E_bins</span></tt></dt>
<dd>The <tt class="docutils literal"><span class="pre">n_E+1</span></tt> incident photon energy boundaries (&#8220;edges&#8221; in BATSE parlance) defining
the DRM.  Peculiarly, this is provided as if some kind of binning was done in
incident photon energy, making the energy assignment for a particular DRM
entry ambiguous.  Currently I suggest using the center of the <tt class="docutils literal"><span class="pre">E_bins</span></tt> bin; this
needs further exploration.</dd>
<dt><tt class="docutils literal"><span class="pre">drm</span></tt></dt>
<dd>The DRM as an <tt class="docutils literal"><span class="pre">n_ch</span></tt> by <tt class="docutils literal"><span class="pre">n_E</span></tt> array.</dd>
<dt><tt class="docutils literal"><span class="pre">crv</span></tt></dt>
<dd>A list of <tt class="docutils literal"><span class="pre">n_ch</span></tt> channel response vectors (CRVs), each an array of
length <tt class="docutils literal"><span class="pre">n_E</span></tt>.  These are just different views of the DRM,
useful for calculating expected count rates for individual channels.</dd>
<dt><tt class="docutils literal"><span class="pre">start</span></tt></dt>
<dd>The response is vanishingly small at low energies.  <tt class="docutils literal"><span class="pre">start[i]</span></tt>
is the index of the first value of <tt class="docutils literal"><span class="pre">j</span></tt> for which <tt class="docutils literal"><span class="pre">drm[i,j]</span></tt> is
non-zero.</dd>
</dl>
<p>The summed response of the triggered detectors (the <em>detector-summed</em> response)
is available via similar attributes of <tt class="docutils literal"><span class="pre">discsc_drms</span></tt> itself: <tt class="docutils literal"><span class="pre">ch_bins</span></tt>,
<tt class="docutils literal"><span class="pre">E_bins</span></tt>, <tt class="docutils literal"><span class="pre">drm</span></tt>, <tt class="docutils literal"><span class="pre">crv</span></tt>, and <tt class="docutils literal"><span class="pre">start</span></tt>.</p>
<p>The following block of code plots the detector-summed response for each of the
four DISC channels in a single figure.  Note that <tt class="docutils literal"><span class="pre">E_vals</span></tt> is set equal to the
incident energy bin centers.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">drms</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">discsc_drms</span>
<span class="n">d0</span> <span class="o">=</span> <span class="n">drms</span><span class="o">.</span><span class="n">detectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">drms</span><span class="o">.</span><span class="n">detectors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">E_vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">drms</span><span class="o">.</span><span class="n">E_bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">drms</span><span class="o">.</span><span class="n">E_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">drms</span><span class="o">.</span><span class="n">n_ch</span><span class="p">):</span>
        <span class="n">semilogx</span><span class="p">(</span><span class="n">E_vals</span><span class="p">,</span> <span class="n">drms</span><span class="o">.</span><span class="n">crv</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$E$ (keV)&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s">r&#39;$R_i(E)$ (cm$^2$)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">DRMs_DISCSC</span></tt> provides methods for numerical integration of the product
of an incident spectrum model and the response function for each channel; the
result is the expected number of detected photons (&#8220;counts&#8221;) in the channel.
This quadrature capability is provided only for the <em>detector-summed</em> response.</p>
<p>The quadrature is done using an interpolatory inner product quadrature rule that
uses evaluations of the response function and the spectrum at <em>different</em>
points, to account for different availability and scales of variation of these
two factors.  Currently, only one rule is available:  For each incident energy
interval in a channel response vector, the rule uses the two response values at
the interval boundaries, and three spectrum values within the interval, located
at the zeroes of a 2nd-degree Legendre polynomial over the interval.  This
corresponds to linear interpolation of the response function, and 5th-degree
polynomial interpolation of the spectrum, over each DRM incident energy
interval.</p>
<p>Note that the DRMs for all channels share common incident energy bins, so
the quadrature rules for all channels share common incident energy nodes.</p>
<p>To set up the rules for every channel of the detector-summed response for a
burst&#8217;s DISC data, call the <tt class="docutils literal"><span class="pre">set_sum_prodquad</span></tt> method of the burst&#8217;s
<tt class="docutils literal"><span class="pre">DRMs_DISCSC</span></tt> object. This defines a product quadrature rule for each channel;
it also compiles the nodes (incident energy values used in the rules) and makes
them available as an array via the <tt class="docutils literal"><span class="pre">quad_nodes</span></tt> attribute, so
<tt class="docutils literal"><span class="pre">quad_nodes[j]</span></tt> returns the <tt class="docutils literal"><span class="pre">j'th</span></tt> energy value (the nodes are the same
for all channels). The
<tt class="docutils literal"><span class="pre">chan_quad(i,</span> <span class="pre">spec)</span></tt> method calculates the quadrature for channel <tt class="docutils literal"><span class="pre">i</span></tt> for
input spectrum <tt class="docutils literal"><span class="pre">spec</span></tt>. The spectrum can be provided as a function (of incident
photon energy), or as a vector of values pre-calculated on the nodes (this will
be faster if results are sought for more than one channel).  If a spectrum
function is used that requires arguments besides the photon energy, those
arguments can be provided to <tt class="docutils literal"><span class="pre">chan_quad</span></tt> as additional arguments; e.g., for a
spectrum with parameters <tt class="docutils literal"><span class="pre">p1</span></tt> and <tt class="docutils literal"><span class="pre">p2</span></tt>, the signature would be:
<tt class="docutils literal"><span class="pre">chan_quad(i,</span> <span class="pre">spec,</span> <span class="pre">p1,</span> <span class="pre">p2)</span></tt>.</p>
<p>The following block of code pre-calculates spectrum values and calculates
the expected number of counts for BATSE channels 1 and 2 (indices 0 and 1).
It assumes a spectrum function <tt class="docutils literal"><span class="pre">spec(E)</span></tt> exists, and that it can accept
array arguments.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">drms</span> <span class="o">=</span> <span class="n">grb</span><span class="o">.</span><span class="n">discsc_drms</span>
<span class="n">drms</span><span class="o">.</span><span class="n">set_sum_prodquad</span><span class="p">()</span>
<span class="n">svals</span> <span class="o">=</span> <span class="n">spec</span><span class="p">(</span><span class="n">drms</span><span class="o">.</span><span class="n">quad_nodes</span><span class="p">)</span>  <span class="c"># channels have common E values</span>
<span class="n">exp_cts_0</span> <span class="o">=</span> <span class="n">drms</span><span class="o">.</span><span class="n">chan_quad</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">svals</span><span class="p">)</span>
<span class="n">exp_cts_1</span> <span class="o">=</span> <span class="n">drms</span><span class="o">.</span><span class="n">chan_quad</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">svals</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2013, Tom Loredo.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>